<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stripe Analytics Empire - Professional Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="components.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Enhanced dashboard-specific styles */
        .enhanced-dashboard {
            animation: fadeIn 0.8s ease-out;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .chart-container {
            animation: slideUp 0.6s ease-out;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .data-table-section {
            animation: slideUp 0.8s ease-out;
        }
    </style>
</head>
<body>
    <!-- Reusable header component will be inserted here -->
    
    <div class="enhanced-dashboard">
        <div class="dashboard-grid">
            <div class="chart-container">
                <h2 class="chart-title">üéØ Total Revenue Performance</h2>
                <div id="revenueOverviewChart"></div>
            </div>
            
            <div class="chart-container">
                <h2 class="chart-title">üí≥ Transaction Status Distribution</h2>
                <div id="transactionStatusChart"></div>
            </div>
            
            <div class="chart-container">
                <h2 class="chart-title">üåç Geographic Revenue Distribution</h2>
                <div id="geographicRevenueChart"></div>
            </div>
            
            <div class="chart-container">
                <h2 class="chart-title">üìà Revenue Growth Trend</h2>
                <div id="revenueGrowthChart"></div>
            </div>
        </div>
        
        <div class="metrics-grid">
            <div class="chart-container" style="grid-column: span 2;">
                <h2 class="chart-title">üí∞ Average Transaction Value</h2>
                <div id="avgTransactionValue"></div>
            </div>
            
            <div class="chart-container">
                <h2 class="chart-title">üë• Active Customers</h2>
                <div id="activeCustomersChart"></div>
            </div>
            
            <div class="chart-container" style="grid-column: span 2;">
                <h2 class="chart-title">‚ö° Processing Success Rate</h2>
                <div id="processingSuccessRate"></div>
            </div>
        </div>
        
        <div class="data-table-section">
            <h2 class="chart-title">üìä Recent Transactions</h2>
            <div class="table-container">
                <table id="recentTransactions">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Amount</th>
                            <th>Customer</th>
                            <th>Method</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="transactionsBody">
                        <!-- Data will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p>Loading analytics dashboard...</p>
    </div>

    <script>
        // Initialize enhanced dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for components to load
            setTimeout(() => {
                initializeEnhancedDashboard();
            }, 100);
        });

        function initializeEnhancedDashboard() {
            // Load main dashboard data
            const dashboardData = {
                totalRevenue: 24567,
                transactionStats: {
                    succeeded: 98.7,
                    failed: 1.3,
                    processing: 0.8
                },
                geographicData: [
                    {country: 'United States', revenue: 18900, transactions: 234},
                    {country: 'United Kingdom', revenue: 8900, transactions: 89},
                    {country: 'Canada', revenue: 6700, transactions: 67},
                    {country: 'Germany', revenue: 4500, transactions: 45}
                ],
                revenueGrowth: [
                    {month: 'Jan', amount: 8500},
                    {month: 'Feb', amount: 12000},
                    {month: 'Mar', amount: 18900},
                    {month: 'Apr', amount: 22000},
                    {month: 'May', amount: 28900},
                    {month: 'Jun', amount: 34500}
                ],
                transactions: [
                    {date: '2025-02-28', amount: 49900, customer: 'Samuel Polsky', method: 'Visa', status: 'succeeded'},
                    {date: '2025-02-27', amount: 39900, customer: 'Rodman Henley', method: 'Mastercard', status: 'succeeded'},
                    {date: '2025-02-27', amount: 39900, customer: 'Rodman Henley', method: 'Mastercard', status: 'succeeded'},
                    {date: '2025-01-30', amount: 29900, customer: 'Samuel Polsky', method: 'Visa', status: 'succeeded'}
                ]
            };
            
            // Update header with real data
            if (window.components && window.components.header) {
                window.components.header.updateStats({
                    totalRevenue: dashboardData.totalRevenue,
                    activeUsers: 1247,
                    totalTransactions: 3,
                    successRate: dashboardData.transactionStats.succeeded
                });
            }
            
            createRevenueOverviewChart(dashboardData);
            createTransactionStatusChart(dashboardData);
            createGeographicRevenueChart(dashboardData);
            createRevenueGrowthChart(dashboardData);
            createAvgTransactionValue(dashboardData);
            createActiveCustomersChart(dashboardData);
            createProcessingSuccessRate(dashboardData);
            populateTransactionsTable(dashboardData);
            
            hideLoading();
        }

        function createRevenueOverviewChart(data) {
            const trace = {
                x: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                y: [8500, 12000, 18900, 22000, 28900, 34500],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Monthly Revenue',
                line: {color: '#6366f1', width: 4},
                marker: {
                    color: '#6366f1',
                    size: data.revenueGrowth.map(d => d.amount / 1000),
                    line: {color: 'white', width: 2}
                },
                fill: 'tozeroy',
                fillcolor: 'rgba(99, 102, 241, 0.2)'
            };

            const layout = {
                title: 'Revenue Performance Overview',
                xaxis: {title: 'Month'},
                yaxis: {title: 'Revenue ($)'},
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: {color: '#374151'},
                margin: {t: 20, r: 20, b: 40, l: 60}
            };

            Plotly.newPlot('revenueOverviewChart', [trace], layout, {responsive: true});
        }

        function createTransactionStatusChart(data) {
            const stats = data.transactionStats;
            
            const trace = {
                x: ['Succeeded', 'Failed', 'Processing'],
                y: [stats.succeeded, stats.failed, stats.processing],
                type: 'bar',
                marker: {
                    color: ['#10b981', '#ef4444', '#f59e0b'],
                    line: {color: 'white', width: 2}
                },
                text: [`${stats.succeeded}%`, `${stats.failed}%`, `${stats.processing}%`],
                textposition: 'auto',
                textfont: {color: 'white', size: 12}
            };

            const layout = {
                title: 'Transaction Status Distribution',
                xaxis: {title: 'Status'},
                yaxis: {title: 'Percentage (%)'},
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: {color: '#374151'},
                margin: {t: 20, r: 20, b: 40, l: 60}
            };

            Plotly.newPlot('transactionStatusChart', [trace], layout, {responsive: true});
        }

        function createGeographicRevenueChart(data) {
            const geoData = data.geographicData;
            
            const trace = {
                type: 'choropleth',
                locationmode: 'country names',
                locations: geoData.map(g => g.country),
                z: geoData.map(g => g.revenue),
                text: geoData.map(g => `${g.country}: $${g.revenue.toLocaleString()}`),
                colorscale: 'Viridis'
            };

            const layout = {
                title: 'Geographic Revenue Distribution',
                geo: {
                    scope: 'world',
                    showframe: false,
                    bgcolor: 'rgba(0,0,0,0)',
                    projection: {type: 'mercator'}
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: {color: '#374151'},
                margin: {t: 20, r: 20, b: 40, l: 20}
            };

            Plotly.newPlot('geographicRevenueChart', [trace], layout, {responsive: true});
        }

        function createRevenueGrowthChart(data) {
            const growth = data.revenueGrowth;
            
            const trace = {
                x: growth.map(g => g.month),
                y: growth.map(g => g.amount),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Revenue Growth',
                line: {color: '#22d3ee', width: 3},
                marker: {
                    color: '#22d3ee',
                    size: 10,
                    line: {color: 'white', width: 2}
                },
                fill: 'tozeroy',
                fillcolor: 'rgba(34, 211, 238, 0.1)'
            };

            const layout = {
                title: 'Revenue Growth Trend',
                xaxis: {title: 'Month'},
                yaxis: {title: 'Revenue ($)'},
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: {color: '#374151'},
                margin: {t: 20, r: 20, b: 40, l: 60}
            };

            Plotly.newPlot('revenueGrowthChart', [trace], layout, {responsive: true});
        }

        function createAvgTransactionValue(data) {
            const avgValue = data.transactions.reduce((sum, tx) => sum + tx.amount, 0) / data.transactions.length;
            
            const trace = {
                type: 'indicator',
                mode: 'number+delta',
                value: avgValue,
                number: {font: {size: 48, color: '#6366f1'}, suffix: 'Average: '},
                delta: {position: 'top', valuefont: {size: 24, color: '#10b981'}},
                title: {text: 'Avg Transaction Value', font: {size: 14, color: '#374151'}},
                domain: {x: [0, 100], y: [0, 5000]},
            };

            const layout = {
                title: 'Average Transaction Value',
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: {color: '#374151'},
                margin: {t: 20, r: 20, b: 40, l: 60}
                height: 200
            };

            Plotly.newPlot('avgTransactionValue', [trace], layout, {responsive: true});
        }

        function createActiveCustomersChart(data) {
            const trace = {
                type: 'indicator',
                mode: 'number+delta',
                value: 1247,
                number: {font: {size: 48, color: '#6366f1'}, suffix: ' Active Users'},
                title: {text: 'Active Customers', font: {size: 14, color: '#374151'}},
                domain: {x: [0, 100], y: [0, 5000]},
            };

            const layout = {
                title: 'Active Customers',
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: {color: '#374151'},
                margin: {t: 20, r: 20, b: 40, l: 60},
                height: 200
            };

            Plotly.newPlot('activeCustomersChart', [trace], layout, {responsive: true});
        }

        function createProcessingSuccessRate(data) {
            const rate = data.transactionStats.succeeded;
            
            const trace = {
                type: 'indicator',
                mode: 'gauge+number+delta',
                value: rate,
                gauge: {
                    axis: {range: [null, 100], visible: true},
                    bar: {color: '#10b981'}, thickness: 15},
                    steps: [{
                        range: [0, 70], color: '#ef4444'},
                        range: [70, 90], color: '#f59e0b'},
                        range: [90, 100], color: '#10b981'}
                    }],
                    threshold: {
                        line: {color: '#6366f1', width: 2},
                        thickness: 2,
                        value: 95
                    }
                },
                domain: {x: [0, 100], y: [0, 5000]},
                delta: {reference: 80, position: 'top', valuefont: {size: 16, color: '#10b981'}},
                title: {text: 'Processing Success Rate', font: {size: 14, color: '#374151'}},
            };

            const layout = {
                title: 'Processing Success Rate',
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: {color: '#374151'},
                margin: {t: 20, r: 20, b: 40, l: 60}
                height: 300
            };

            Plotly.newPlot('processingSuccessRate', [trace], layout, {responsive: true});
        }

        function populateTransactionsTable(data) {
            const tbody = document.getElementById('transactionsBody');
            tbody.innerHTML = '';
            
            data.transactions.forEach(tx => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${tx.date}</td>
                    <td>$${tx.amount.toLocaleString()}</td>
                    <td>${tx.customer}</td>
                    <td>${tx.method}</td>
                    <td><span class="status-badge status-success">${tx.status}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        function hideLoading() {
            const loading = document.getElementById('loading');
            if (loading) {
                loading.style.display = 'none';
            }
        }
    </script>
</body>
</html>